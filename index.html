<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <title>chat test</title>
    <meta name="title" content="chat test " />
    <link rel="shortcut icon" href="gb.png" type="image/x-icon">
    <meta name="description" content="test ya rayen" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="link comming soon" />
    <meta property="og:title" content="chat test " />
    <meta property="og:description" content="test ya rayen" />
    <meta property="og:image" content="blasit il toswira ili tothhor m3a link">
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="link comming soon" />
    <meta property="twitter:title" content="chat test " />
    <meta property="twitter:description" content="test ya rayen" />
    <meta property="twitter:image" content="blasit il toswira ili tothhor m3a link" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
        <style>
            body {
                font-family: Arial, sans-serif;
                margin: 0;
                padding: 0;}
            @media (max-width: 980px){
                .container {
                max-width: 400px;
                margin: 5%
                }
                label{
                  margin: 0px;
                  padding: 0px;
                }
            }
            .container {
                max-width: 700px;
                margin: 0 auto;
                padding: 20px;
            }
    
            form {
                background-color: #0099ffbb;
                padding: 20px;
                margin-bottom: 20px;
                border-radius: 5px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }
    
            form textarea,input {
                width: 95%;
                padding: 10px;
                margin-bottom: 5px;
                border: 1px solid #ccc;
                border-radius: 5px;
                resize: vertical;
            }
            label{
              border: 1px solid #ccc;
              border-radius: 5px;
              background-color: white;
              color: black;
              font-family: cursive;
            }
    
            form button {
                padding: 10px 20px;
                background-color: #007bff;
                color: #fff;
                border: none;
                border-radius: 5px;
                cursor: pointer;
            }
    
            #postsContainer {
                background-color: #00a2ff;
                padding: 20px;
                border-radius: 5px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            }
    
            .message {
                margin-bottom: 20px;
                padding: 10px;
                background-color: #e96a6ade;
                border-radius: 5px;
                box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            }
    
            .timestamp {
                font-weight:lighter;
                color: #4e4e4ed2;
            }
            h2{
                color: rgb(255, 166, 0);
            }
        </style>
    </head>
    <body>
        <div class="container">
            <br>
            <form id="submitForm" action="https://script.google.com/your google sheets url" method="POST">
              <input type="text" name="name" placeholder="Write the subject">
              <textarea name="message" placeholder="talk about what ever you too like" required></textarea>
             <center><button type="submit">Submit</button></center>
          </form>
          <div id="postsContainer"></div>
      </div>
      <script>
        // Listen for form submission
        document.getElementById('submitForm').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent form submission
    
            // Display success alert
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: 'wait 5 sec..',
                timer: 5000, // Set timer for 5 seconds
                timerProgressBar: true,
                onClose: () => {
                    // Submit the form data after the alert is closed
                    this.submit();
                }
            });
        });
    
        // Fetch data from Google Sheets
        fetch('https://script.google.com/your google sheets url')
            .then(response => response.json())
            .then(data => {
                const postsContainer = document.getElementById('postsContainer');
    
                // Reverse the array of data
                data.reverse();
    
                // Iterate through the reversed data array to create HTML elements
                data.forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.classList.add('message');
                    postElement.innerHTML = `
                    <h2>${post.name}</h2>
                    <strong>
                        <h3>${post.message}</h3>
                    </strong>
                    <p class="timestamp">${post.timestamp}</p>
                    `;
                    postsContainer.appendChild(postElement);
                });
            })
            .catch(error => console.error('Error fetching data:', error));
    </script>
        <script>
            // Handle form submission
            document.querySelector('form').addEventListener('submit', async function(event) {
              event.preventDefault(); // Prevent default form submission behavior
    
              // Fetch data from the form
              const formData = new FormData(this);
    
              try {
                // Submit form data to the server
                const response = await fetch(this.action, {
                  method: 'POST',
                  body: formData
                });
    
                // Check if the form submission was successful
                if (response.ok) {
                  // Clear the form input after successful submission (optional)
                  this.reset();
                  // Reload the page after a successful submission
                  window.location.reload();
                } else {
                  console.error('Form submission failed:', response.statusText);
                }
              } catch (error) {
                console.error('Error submitting form:', error);
              }
            });
          </script>
          <script>
            // Function to fetch data from Google Sheets
            function fetchData() {
                fetch('https://script.google.com/your google sheets url')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        const postsContainer = document.getElementById('postsContainer');
        
                        // Reverse the array of data
                        data.reverse();
        
                        // Check if there's a difference in the data
                        const currentData = JSON.stringify(data);
                        const previousData = localStorage.getItem('previousData');
                        if (currentData !== previousData) {
                            // Data has changed, reload the page
                            localStorage.setItem('previousData', currentData);
                            window.location.reload();
                        }
        
                        // Schedule the next data fetch in 4 seconds
                        setTimeout(fetchData, 4000);
                    })
                    .catch(error => console.error('Error fetching data:', error));
            }
        
            // Call fetchData function initially
            fetchData();
        </script>
        
        <script>
            function checkForNewMessages() {
            fetch('https://script.google.com/your google sheets url')
                .then(response => response.json())
                .then(data => {
                    // Check if there are new messages
                    if (data.length > 0) {
                        // Notify the user about the new messages
                        alert('New anonymous message posted!');
                        }
                    })
                    .catch(error => console.error('Error checking for new messages:', error));
            }
    
            // Check for new messages every 30 seconds
            setInterval(checkForNewMessages, 25000);
    
        </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    </body>
    </html>
    
    