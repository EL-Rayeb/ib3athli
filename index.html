<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <title>chat test</title>
    <meta name="title" content="chat test " />
    <link rel="shortcut icon" href="gb.png" type="image/x-icon">
    <meta name="description" content="test ya rayen" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="link comming soon" />
    <meta property="og:title" content="chat test " />
    <meta property="og:description" content="test ya rayen" />
    <meta property="og:image" content="blasit il toswira ili tothhor m3a link">
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="link comming soon" />
    <meta property="twitter:title" content="chat test " />
    <meta property="twitter:description" content="test ya rayen" />
    <meta property="twitter:image" content="blasit il toswira ili tothhor m3a link" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <style>
        body {
            font-family: "Source Code Pro", monospace;
            font-optical-sizing: auto;
            font-weight: thick;
            font-style: normal;
            margin: 0;
            padding: 0;
            background-color: #000000;
        }

        @media (max-width: 980px) {
            .container {
                max-width: 400px;
                margin: 5%
            }

            img {
                width: 50% !important;
                margin-top: 4%;
            }

            label {
                margin-right: 1%;
                padding: 0px;
                display: flex;
                justify-content: center;
            }

            h2 {
                display: flex;
                align-items: center;
            }
        }

        .container {
            max-width: 700px;
            margin: 0 auto;
            padding: 20px;
            padding-top: 5px;
        }

        form {
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        form textarea,
        input {
            width: 95%;
            padding: 10px;
            border: 1px solid rgb(0, 255, 0);
            background-color: rgb(0, 0, 0);
            color: orange;
            border-radius: 5px;
            resize: vertical;
        }

        input[type=text] {
            text-align: center;
        }

        label {
            font-weight: lighter;
            margin-bottom: 5px;
            border: 1px solid rgb(0, 255, 0);
            background-color: rgb(0, 0, 0);
            color: orange;
            font-family: 'Gill Sans', 'Gill Sans MT', Calibri, 'Trebuchet MS', sans-serif;
        }

        form button {
            padding: 10px 20px;
            background-color: rgb(0, 255, 0);
            color: rgb(0, 0, 0);
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #postsContainer {
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgb(0, 255, 34);
        }

        .message {
            margin-bottom: 20px;
            padding: 10px;
            background-color: rgb(0, 0, 0);
            border-radius: 5px;
            color: white;
            box-shadow: 0 1px 3px rgb(106, 235, 0);
        }

        .timestamp {
            font-weight: lighter;
            color: #a2a3cea4;
            font-family: 'Times New Roman', Times, serif;
            float: right;
            font-size: small;
        }

        h2 {
            color: rgb(255, 115, 0);
        }
        button:hover {
            background-color: #ff0000;
            color: rgb(255, 255, 255);
        }
        .swal2-popup-color {
            background-color: black !important;
        }

        .swal2-backdrop-color {
            background-color: rgba(0, 0, 0, 0.5) !important;
        }
    </style>
</head>
<body translate="no">
        <form id="submitForm" action="" method="POST">
            <input type="hidden" id="ipAddressInput" name="ipAddress">
            <input type="text" name="name" placeholder="Name | Subject | Empty" ><br>
            <center><label for="name" style="color: green;font-weight: lighter;"><small>&ThickSpace;tijim tiktbo tijim la&ThickSpace;</small></label></center>
            <textarea id="message" name="message" placeholder="Write your anonymous message here..." required style="margin-bottom: 5px;"></textarea>
            <article style="color:rgb(236, 82, 82);"><strong>Note</strong>:<small style="color: honeydew;"> after pressing submit wait 5sec dont spam or the messge will double</small></article>
            <input type="hidden" id="userAgentInput" name="userAgent">
            <input type="hidden" id="referrerUrlInput" name="referrerUrl">
            <div style="flex: 4; display: flex;">
                <button type="submit" style="padding: 10px 20px; background-color: #9dff00; color: #000000; border: none; border-radius: 5px; flex: 3;">Submit</button>
                <button onclick="copyLink()" style="margin-left: 10px; padding: 10px 20px; background-color: #0099ff; color: #ffffff; border: none; border-radius: 5px; flex: 1;">Share</button>
            </div>
        </form>
        <div id="postsContainer"></div>

    <script>
        $(function() {
          var availableSuggestions = [
            "<img src=\"url\">",
            "<p style=\"color:\">iktib ili t7ib</p>",
            "sawsan ya3tik 3asba",
            // Add more suggestions as needed
          ];

          $("#message").autocomplete({
            source: availableSuggestions,
            minLength: 1,
            select: function(event, ui) {
              var cursorPos = $("#message").prop("selectionStart");
              var textBefore = $("#message").val().substring(0, cursorPos);
              var textAfter = $("#message").val().substring(cursorPos);
              var selectedSuggestion = ui.item.value;
              $("#message").val(selectedSuggestion + textAfter);
              return false;
            },
            create: function() {
              $(this).data('ui-autocomplete')._renderItem = function(ul, item) {
                return $('<li>')
                  .append($('<div>').text(item.label))
                  .appendTo(ul);
              };
            }
          });
        });
      </script>
    <script>
        // Listen for form submission
        document.getElementById('submitForm').addEventListener('submit', function (event) {
            event.preventDefault(); // Prevent form submission

            // Display success alert with a black background
            Swal.fire({
                icon: 'success',
                title: 'Success!',
                text: 'Wait 5 seconds...',
                timer: 3000, // Set timer for 5 seconds
                timerProgressBar: true,
                customClass: {
                        backdrop: 'swal2-backdrop-color',
                        popup: 'swal2-popup-color'
                    },
            });
        });

        // Fetch data from Google Sheets
        fetch('https://script.google.com/macros/s/AKfycbwEvL1LE2Fj59sKHYiGxx8GyVMG6inP5cYoV9ZdxNKrKF_6LR1BDKSZejBfL6NUCw/exec')
            .then(response => response.json())
            .then(data => {
                const postsContainer = document.getElementById('postsContainer');

                // Reverse the array of data
                data.reverse();

                // Iterate through the reversed data array to create HTML elements
                data.forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.classList.add('message');
                    postElement.innerHTML = `
                        <h2>${post.name}</h2>
                            <h3>${post.message}</h3>
                        <p class="timestamp">${post.timestamp}</p>
                        `;
                    postsContainer.appendChild(postElement);
                });
            })
            .catch(error => console.error('Error fetching data:', error));

    </script>  
    <script>
        // Function to fetch the user's IP address from a third-party service
        async function fetchIpAddress() {
          try {
            const response = await fetch('https://api.ipify.org/?format=json');
            const data = await response.json();
            return data.ip;
          } catch (error) {
            console.error('Error fetching IP address:', error);
            return null;
          }
        }
        
        // Function to get the User Agent string
        function getUserAgent() {
          return navigator.userAgent;
        }
        
        // Function to get the Referrer URL
        function getReferrerUrl() {
          return document.referrer || "Not provided";
        }

        // Call fetchIpAddress function and update the form with the IP address
        fetchIpAddress().then(ipAddress => {
          if (ipAddress) {
            document.getElementById('ipAddressInput').value = ipAddress;
            document.getElementById('userAgentInput').value = getUserAgent();
            document.getElementById('referrerUrlInput').value = getReferrerUrl();
          }
        });
    </script>
    <script>
        // Handle form submission
        document.querySelector('form').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent default form submission behavior

            // Fetch data from the form
            const formData = new FormData(this);

            try {
                // Submit form data to the server
                const response = await fetch(this.action, {
                    method: 'POST',
                    body: formData
                });

                // Check if the form submission was successful
                if (response.ok) {
                    // Clear the form input after successful submission (optional)
                    this.reset();
                    // Reload the page after a successful submission
                    // window.location.reload();
                } else {
                    console.error('Form submission failed:', response.statusText);
                }
            } catch (error) {
                console.error('Error submitting form:', error);
            }
        });
    </script>
    <script>
        // Function to fetch data from Google Sheets
        function fetchData() {
            fetch('https://script.google.com/macros/s/AKfycbwEvL1LE2Fj59sKHYiGxx8GyVMG6inP5cYoV9ZdxNKrKF_6LR1BDKSZejBfL6NUCw/exec')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    const postsContainer = document.getElementById('postsContainer');

                    // Reverse the array of data
                    data.reverse();

                    // Check if there's a difference in the data
                    const currentData = JSON.stringify(data);
                    const previousData = localStorage.getItem('previousData');
                    if (currentData !== previousData) {
                        // Data has changed, reload the page
                        localStorage.setItem('previousData', currentData);
                        window.location.reload();
                    }

                    // Schedule the next data fetch in 5 seconds
                    setTimeout(fetchData, 5000);
                })
                .catch(error => console.error('Error fetching data:', error));
        }

        // Call fetchData function initially
        fetchData();
    </script>
        <script>
            function copyLink() {
                // share 'https://sus.run/sqbcq' with shortened share link
                var linkToCopy = 'https://rebrand.ly/x9b8cjp';
                
                // Create a temporary input element
                var tempInput = document.createElement('input');
                tempInput.value = linkToCopy;
                document.body.appendChild(tempInput);
                
                // Select the input element's text
                tempInput.select();
                tempInput.setSelectionRange(0, 99999); // For mobile devices
                
                // Copy the text to the clipboard
                document.execCommand('copy');
                
                // Remove the temporary input element
                document.body.removeChild(tempInput);
                
                // Provide feedback to the user using SweetAlert
                Swal.fire({
                    icon: 'success',
                    title: 'Link copied to clipboard',
                    text: linkToCopy,
                    confirmButtonColor: '#007bff',
                    customClass: {
                        backdrop: 'swal2-backdrop-color',
                        popup: 'swal2-popup-color'
                    }
                });
            }
        </script>
    <script src="sweetalert2.min.js"></script>
    <script src="sweetalert2/dist/sweetalert2.min.js"></script>

</body>

</html>